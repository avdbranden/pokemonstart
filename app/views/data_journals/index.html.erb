<div class="data-journal-intro text-center">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-md-10 col-md-offset-1">
        <div class="data-journal-first">
          <h1>Data privacy dashboard</h1>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Esse nobis debitis atque qui officia, tenetur laudantium nulla illum aliquid, error eaque unde fugit eveniet ea, mollitia asperiores eum sapiente quaerat!</p>
        </div>
        </div>
    </div>
  </div>
</div>

<div class="data-journal-data-overview">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-md-10 col-md-offset-1">
        <h2>Data currently udergoing processing</h2>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Esse nobis debitis atque qui officia, tenetur laudantium nulla illum aliquid, error eaque unde fugit eveniet ea, mollitia asperiores eum sapiente quaerat!</p>
        <p></p>

        <!-- Authorize changes button-->
        <div class="data-journal-manage-auth-btn text-center">
          <%= link_to "Change data privacy authorizations", "", class: "btn btn-primary btn-lg", id: "btn-authorize" %>
        </div>


        <!-- Overview data table-->
        <div class="table-responsive data-privacy-table">
          <table class="table table-striped table-hover table-bordered">
            <thead>
              <tr>
                <td>#</td>
                <td>Type</td>
                <td>Data</td>
                <td>Consent status</td>
                <td>As from</td>
              </tr>
            </thead>
            <tbody>
              <% counter = 0 %>
              <% consent_status = @data_journal.consent_active ? "Active" : "Not active" %>
              <% @attributes.each do |type, data| %>
              <tr>
                <td><%= counter += 1 %></td>
                <td><%= type %></td>
                <td><%= data %></td>
                <% # Use of required? helper %>
                <% # if User model validates presence true of type %>
                <% # -add 'required' and 'danger' class to input checkbox %>
                <% # -fire warning tooltip %>
                <% if required?(User, type) %>
                <td class="danger consent-td" data-toggle="tooltip" data-placement="right" title="Data mandatory for continuing processing">
                  <div class="consent-status">
                    <%= consent_status %>
                  </div>
                  <div class="consent-checkbox">
                    <input type="checkbox" id="<%= type %>" class="consent-status disabled required" checked="checked" disabled="disabled">
                  </div>
                  <div class="consent-warning">
                    (Required)
                  </div>
                </td>
                <% # if not, add 'not-required' class to input checkbox %>
                <% else %>
                  <td class="primary consent-td">
                    <div class="consent-status">
                      <%= consent_status %>
                    </div>
                    <div class="consent-checkbox">
                      <input type="checkbox" id="<%= type %>" class="consent-status disabled not-required" checked="checked" disabled="disabled">
                    </div>
                    <div class="consent-warning">
                      (Optional)
                    </div>
                  </td>
                <% end %>
                <td><%= current_user.created_at.strftime("%b %d, %Y") %></td>
              </tr>
              <% end %>
            </tbody>
          </table>
        </div>

        <!-- Confirm changes button-->
        <div id="password-confirmation">
          <%= simple_form_for [current_user, @data_journal], url: url_for([current_user, @data_journal]), method: :patch do |f| %>
            <%= f.error_notification %>
             <div class="form-inputs">
               <%= f.input :current_password, hint: "we need your current password to confirm your changes", required: true %>
             </div>
             <div class="form-actions">
               <%= f.button :submit, "Confirm changes", class: "btn btn-danger btn-lg" %>
             </div>
           <% end %>
        </div>


      </div>
    </div>
  </div>
</div>
